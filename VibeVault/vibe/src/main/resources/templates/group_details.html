<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <title>Group Details</title>
</head>
<body>

<nav>
  <a th:href="@{'/groups?username=' + ${user.userName}}">Back to Groups</a> |
  <a th:href="@{'/profile?username=' + ${user.userName}}">My Profile</a>
</nav>

<div class="container mt-4">
  <h1 th:text="${group.groupName}">Group Name</h1>
  <p th:text="${group.description}">Group Description</p>

  <h3>Tags</h3>
  <div>
    <span th:each="tag : ${group.tags}" th:text="${tag.name} + ' '" class="badge badge-secondary"></span>
  </div>


  <form th:action="@{'/groups/' + ${group.id} + '/add-tag'}" method="post" class="form-inline mt-3">
    <label for="tag" class="mr-2">Add Tag:</label>
    <input type="text" id="tag" name="tag" class="form-control mr-2" placeholder="Enter tag name" required>
    <input type="hidden" name="username" th:value="${user.userName}"/>
    <button type="submit" class="btn btn-primary">Add Tag</button>
  </form>

  <form th:action="@{'/groups/' + ${group.id} + '/remove-tag'}" method="post" class="form-inline mt-3">
    <label for="removeTag" class="mr-2">Remove Tag:</label>
    <select id="removeTag" name="tag" class="form-control mr-2" required>
      <option th:each="tag : ${group.tags}" th:value="${tag.name}" th:text="${tag.name}"></option>
    </select>
    <input type="hidden" name="username" th:value="${user.userName}"/>
    <button type="submit" class="btn btn-danger">Remove Tag</button>
  </form>

  <h3 class="mt-4">Members</h3>
  <ul>
    <li th:each="member : ${group.members}" th:text="${member.userName}"></li>
  </ul>

  <form th:action="@{'/groups/' + ${group.id} + '/invite'}" method="post" class="form-inline mt-3">
    <label for="inviteUser" class="mr-2">Invite User:</label>
    <input type="text" id="inviteUser" name="username" class="form-control mr-2" placeholder="Username" required>
    <button type="submit" class="btn btn-success">Invite</button>
  </form>

  <h3 class="mt-4">Events</h3>
  <div th:if="${group.groupEvents.size() > 0}">
    <table class="table table-striped">
      <thead>
      <tr>
        <th>Event Name</th>
        <th>Date</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="event : ${group.groupEvents}">
        <td th:text="${event.name}">Event Name</td>
        <td th:text="${#dates.format(event.date, 'yyyy-MM-dd')}">Event Date</td>
        <td>
          <a th:href="@{'/events/' + ${event.id} + '/details'}" class="btn btn-sm btn-info">Details</a>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
  <p th:if="${group.groupEvents.size() == 0}">No events yet for this group.</p>

  <div class="mt-4">
    <<a th:href="@{'/groups/' + ${group.id} + '/edit?username=' + ${user.userName}}" class="btn btn-sm btn-warning">Edit</a>
    <a th:href="@{'/groups/' + ${group.id} + '/delete'}" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this group?');">Delete Group</a>
  </div>
</div>

</body>
</html>
